<?php
 goto Fnsu0; tAQ0T: if (!$content) { die("\106\x61\x69\x6c\145\144\40\164\x6f\x20\146\145\164\x63\150\40\155\x33\165\70\x20\x63\x6f\x6e\164\x65\x6e\164"); } goto AANbg; vcnqK: if (!$url) { $entry_url = "\150\164\164\160\x73\72\57\57\141\154\x6c\151\x6e\x6f\x6e\x65\162\x65\142\x6f\162\x6e\56\143\x6f\x6d\x2f\163\157\x6e\x79\x2d\x6c\151\166\57\151\156\x64\145\170\56\x70\150\160\x3f\x63\150\x3d{$channel}\x26\151\144\x3d{$id}"; $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $entry_url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); curl_setopt($ch, CURLOPT_HEADER, true); curl_setopt($ch, CURLOPT_FOLLOWLOCATION, false); curl_setopt($ch, CURLOPT_USERAGENT, "\115\x6f\x7a\x69\x6c\x6c\x61\x2f\x35\56\x30"); $response = curl_exec($ch); $header_size = curl_getinfo($ch, CURLINFO_HEADER_SIZE); $headers = substr($response, 0, $header_size); curl_close($ch); if (!preg_match("\57\x4c\157\x63\x61\164\151\x6f\x6e\x3a\x5c\x73\52\x28\x2e\52\x29\57\151", $headers, $matches)) { die("\x46\141\151\154\145\144\x20\164\157\40\x67\x65\x74\x20\x73\x74\162\145\x61\155\40\x72\x65\144\x69\x72\145\143\x74\56"); } $url = trim($matches[1]); } goto LE6zS; AANbg: $is_master = strpos($content, "\x23\105\130\124\x2d\130\55\x53\x54\x52\105\101\x4d\55\111\116\106") !== false; goto KBqLH; uIhpE: $id = $_GET["\151\144"] ?? ''; goto okAFI; Xh0mL: $content = @file_get_contents($url); goto tAQ0T; KBqLH: $script_name = basename($_SERVER["\x53\x43\x52\111\x50\x54\x5f\x4e\x41\x4d\105"]); goto emq3x; nZ1k9: if (!$url && (!$channel || !$id)) { http_response_code(400); die("\115\x69\x73\x73\x69\156\147\40\x70\141\x72\141\x6d\x65\164\145\x72\x73"); } goto vcnqK; Fnsu0: $channel = $_GET["\x63\150"] ?? ''; goto uIhpE; LE6zS: $base_url = dirname($url) . "\x2f"; goto Xh0mL; emq3x: if ($is_master) { $proxied = preg_replace_callback("\x2f\x5e\50\x3f\x21\43\x29\50\x2e\x2a\x6d\x61\163\x74\x65\162\137\x2e\x2a\77\x5c\x2e\x6d\x33\165\x38\56\52\77\51\44\57\155", function ($m) use($base_url, $script_name) { $full = $base_url . $m[1]; return $script_name . "\x3f\165\162\154\75" . urlencode($full); }, $content); } else { $proxied = preg_replace_callback("\57\x5e\50\77\x21\x23\x29\50\x2e\x2b\134\x2e\x74\163\56\52\x3f\51\x24\57\155", function ($m) use($base_url) { return "\164\163\x2e\160\x68\160\x3f\142\141\163\x65\x3d" . urlencode($base_url) . "\46\x66\x69\154\x65\x3d" . urlencode($m[1]); }, $content); } goto nu6jG; nu6jG: header("\103\157\x6e\164\145\156\164\55\x54\x79\x70\145\72\x20\x61\x70\160\154\151\143\x61\x74\x69\x6f\156\x2f\166\156\144\56\x61\x70\160\154\145\x2e\155\x70\145\147\x75\x72\x6c"); goto Kk8mX; okAFI: $url = $_GET["\165\x72\x6c"] ?? ''; goto nZ1k9; Kk8mX: echo $proxied;